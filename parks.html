<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="style.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js" type="text/javascript"></script>
<script>


$(function() {
	var FIELD_HEIGHT = 8;
	var FIELD_WIDTH = 8;

	var margin_left = 150;
	var margin_top = 50;
	var current_color = '#ddd';
	
	var fields = [];
	var parkColors = ['00008C','006400','808080','8B008B','818000','4682B4','E9967A','2E4E4D'];

	//-----Temperory parks
	/*
	dbpark = ['00008C', 1,9,17,25,33,41,26];
	gpark = ['006400',2,3,4,5,10,11,18,19];
	lgpark = ['808080',6,7,8,12,13,14,15,16,20,22,23,24];
	dgpark = ['2E4E4D',39,47,55,56,59,60,61,62,63,64];
	ppark = ['8B008B',21,27,28,29,34,35,36,43];
	lbpark = ['4682B4',42,49,50,51,57,58];
	opark = ['E9967A',37,44,45,52,53,54];
	ypark = ['818000',30,31,32,38,40,46,48];
	f = [dbpark,gpark,lgpark,dgpark,ppark,lbpark,opark,ypark];
	*/
	//----------------------

	for (var row = 1; row <= FIELD_HEIGHT; row++) 
		{
		for (var col = 1; col <= FIELD_WIDTH; col++) 
		{
			var field_id = (row-1)*FIELD_WIDTH+col;
			$("#container").append('<div class="field" id="'+field_id+'" style="margin-left: '+margin_left+'px; margin-top:'+margin_top+'px">'+field_id+'</div>');

			//for (var i = f.length - 1; i >= 0; i--) 
			//{
			//	if ($.inArray(field_id, f[i]) > -1){
			//		var color = "#"+f[i][0];
			//		$("#"+field_id ).css("background-color", "#ddd");
					fields[field_id] = {"row":row, "col":col, "color":"#ddd", "status":"empty"};
			//	}
			//};
			margin_left += 51;
		};
		margin_left = 150;
		margin_top += 51;
	};
	for (var row = 1; row <= FIELD_HEIGHT*FIELD_WIDTH; row++) {
		console.log(fields[row]);
	}

	for (var i = parkColors.length - 1; i >= 0; i--) {
		$("#colorlist").append('<li class="choicecolor" id="'+parkColors[i]+'" style="background-color: #'+parkColors[i]+';"></li>');
	};


	$('.choicecolor').click(function() { 
        var id = $(this).attr('id');
        $( ".currentcolor #current" ).css( "background-color", "#"+id);
        current_color = "#"+id;
        return false; 
    });

   $('.field').click(function() { 
        var id = $(this).attr('id');
        $( this ).css("background-color", current_color);
        console.log( getAdj(parseInt(id), FIELD_WIDTH, FIELD_HEIGHT) );
        return false; 
    });

   function getAdj(id, w, h){

   		//var w=8; var h=8;
   		if (id == 1) // left up
   			return [id+w,id+w+1,id+1];

   		else if (id == w) // right up
   			return [id-1,id+w,id+w-1];

   		else if (id == w*(h-1)+1) // left down
   			return [id+1,id-w,id-w+1];

   		else if (id == w*h) // right down
   			return [id-1,id-w-1,id-w];

   		else if (id % w - 1 == 0) // left
   			return [id+w,id+w+1,id+1,id-w,id-w+1];

   		else if (id % w == 0) // right
   			return [id+w,id+w-1,id-1,id-w,id-w+1];

   		else if (id < w+1) // up
   			return [id+w-1,id+w,id+w+1,id-1,id+1];

   		else if (id > w*(h-1)) // down
   			return [id-1,id+1,id-w-1,id-w,id-w+1];


   		return [id+w-1,id+w,id+w+1,id-1,id+1,id-w-1,id-w,id-w+1];
   }

   function clearRow(id){
   		for (var i = 0; i < FIELD_WIDTH; i++) {
   			$('#'+field_id+i).css("background-color", "#ddd");
   		};
   }

   function solveParks(r, restricted_cells){
   		var second = 0;
   		var field_id = 0;

   		for (var first = 1; first < FIELD_WIDTH-1; first++) 
   		{
   			//if (first == 2 && r == 1){
   			//	1+1;
   			//}

   			field_id = (r-1)*FIELD_WIDTH+first;
   			var restricted_cells_first = [];

   			if (first == 1){
   				clearRow(field_id);
   			}

   			if (FIELD_WIDTH*(r-1)+first > FIELD_WIDTH*(r-1)+1)
					$('#'+(field_id-1)).css("background-color", "#ddd");

   			if ($.inArray(field_id, restricted_cells) == -1)
   			{
				fields[field_id].status = "tree";

				//if (FIELD_WIDTH*(r-1)+first > FIELD_WIDTH*(r-1)+1)
				//	$('#'+(field_id-1)).css("background-color", "#ddd");
				
				$("#"+field_id).css("background-color", "#555");

				var adjacents_first = getAdj( parseInt(field_id), FIELD_WIDTH, FIELD_HEIGHT) ;
				restricted_cells_first = Array.prototype.concat.apply(restricted_cells_first, adjacents_first);
   			}
   			else{
   				//if (fields[field_id].status == "tree")
   				//	$('#'+field_id).css("background-color", "#ddd");
   				continue;
   			}

   			for (var second = first+2; second < FIELD_WIDTH+1; second++) 
	   		{
	   			var restricted_cells_second = [];
	   			field_id = (r-1)*FIELD_WIDTH+second;

	   			$('#'+(field_id-1)).css("background-color", "#ddd");

	   			if ($.inArray(field_id, restricted_cells) == -1)
	   			{
					fields[field_id].status = "tree";

					//if (8*(r-1)+first > 8*(r-1)+1)
						$('#'+(field_id-1)).css("background-color", "#ddd");

					//if (field_id % 8 != 0)
					//	$("#"+field_id-1).css("background-color", "#ddd");
					$("#"+field_id).css("background-color", "#999");

					var adjacents_second = getAdj( parseInt(field_id), FIELD_WIDTH, FIELD_HEIGHT );
					restricted_cells_second = Array.prototype.concat.apply(restricted_cells_second, adjacents_second);

					if (r < FIELD_HEIGHT) solveParks(r+1, Array.prototype.concat.apply(restricted_cells_second, restricted_cells_first));
	   			}
	   			else{
	   				//if (fields[field_id].status == "tree")
   					//	$('#'+field_id).css("background-color", "#ddd");
   					continue;
	   			}
	   		}
   		};
   		return r;
   }

   console.log(solveParks(1,[]));

});
	
</script>
</head>

<body>

<div id="container" style="width: 800px; height: 600px;">
	
	<div class="colors">
		<ul id="colorlist" style="list-style: none;">
		</ul>
		<div class="currentcolor">Current color
			<div id="current"></div>
		</div>
	</div>

</div>


</body>
</html>